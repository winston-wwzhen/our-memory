# OurMemory 项目文档

## 项目简介

**我们的纪念册 (Our Memory)** 是一款专为情侣设计的微信小程序，旨在通过多种互动功能帮助情侣创造共同的美好回忆。

## 核心功能

### 1. 今日 - AI艺术照片生成
- 拍照/上传照片，AI转换成多种艺术风格
- 支持风格：国风工笔、日漫风、黏土、美式复古、2.5D动画、厚涂手绘、瓷器、莫奈花园等
- VIP用户享受专属风格和更快处理速度
- 每日签到系统，获得爱心能量
- AI照片评分，浪漫指数评估
- 每日任务提供拍照主题

### 2. 乐园 - 互动游乐场
- **宠物乐园**：虚拟宠物系统
  - 喂食、互动、照顾宠物
  - 宠物拥有心情值、体力值、爱心能量
  - 可以让宠物去旅行收集明信片和玫瑰
  - 宠物旅行归来带回特殊物品和留言
- **美食制作**：用爱心能量为宠物准备食物
- **时光胶囊**：情侣时间胶囊系统
  - 埋下留言让伴侣未来发现
  - 接收伴侣的胶囊
  - 最多存储10个胶囊
- **优惠券与决策**：浪漫决策系统
- **留言板**：互相留言功能
- **默契问答**：情侣配对测试

### 3. 时光轴 - 回忆记录
- 展示所有每日照片的时间线
- 显示恋爱里程碑
- 区分恋爱前后的照片
- 显示签到历史记录
- AI评分照片集合

### 4. 我的 - 个人中心
- VIP会员系统
- 每日登录奖励
- 爱心能量管理
- 优惠券兑换
- 情侣头像系统
- 设置和个人资料管理

## 附加功能

### 5. 明信片系统
- 收集宠物旅行带回的明信片
- 每张明信片显示目的地和日期
- 旅行期间收集的特殊物品
- 统计数据（总明信片数、目的地）

### 6. 情侣头像
- 浏览和选择情侣头像
- 详细查看头像选项
- 为情侣提供头像定制

### 7. 时光胶囊
- 情侣间的私密留言系统
- 延时开启功能
- 存储空间管理

### 8. 默契问答
- 情侣默契度测试
- 多轮问答评分系统
- 测试结果历史记录

## 技术架构

### 前端
- 微信小程序框架
- 自定义组件化开发
- 本地存储缓存风格和偏好
- 底部标签页导航（4个主要板块）

### 后端
- 微信云开发
- CloudBase类MongoDB数据库
- 模块化服务架构
- 腾讯云AI图像处理服务
- 环境分离（开发/生产）

### 主要技术栈
- **wx-server-sdk** - 微信云开发
- **腾讯云AI** - 图像风格转换
- **Jimp** - 图像处理
- **Axios** - HTTP请求
- **腾讯云SDK** - 云服务集成

## 云函数列表

1. **get_daily_mission** - 获取每日拍照任务
2. **get_memory_lane** - 获取用户照片时间线
3. **user_center** - 用户相关操作主入口
4. **process_anime** - AI图像处理服务
5. **init_db** - 数据库初始化
6. **init_app_config** - 应用配置初始化
7. **init_avatar_data** - 头像数据初始化
8. **init_destinations** - 旅行目的地数据
9. **init_task_pool** - 每日任务池管理
10. **migrate_legacy_data** - 数据迁移工具

## 数据库集合

- `users` - 用户资料和关系
- `logs` - 活动日志和签到记录
- `daily_picks` - 每日任务分配
- `task_pool` - 可用每日任务
- `quiz_pool` - 问答题库
- `quiz_rounds` - 进行中的问答
- `gardens/pets` - 宠物系统数据
- `destinations` - 旅行地点
- `capsules` - 时光胶囊消息
- `messages` - 留言板帖子
- `coupons` - 可用优惠券
- `vip_codes` - VIP兑换码
- `app_config` - 应用配置
- `avatar_sets` - 头像集合
- `egg_configs` - 彩蛋集合

## 商业化与游戏化

- **VIP系统**：高级功能和更快处理速度
- **爱心能量**：通过每日活动获得的游戏货币
- **广告奖励**：观看广告获得额外拍照次数
- **玫瑰货币**：用于特殊物品的稀有收集品
- **成就系统**：连续签到和里程碑奖励

## 社交功能

- 情侣绑定系统
- 伴侣间的共享活动
- 互相留言系统
- 情侣问答和配对功能
- 通过时间线创造共同回忆

## 特色功能

- **彩蛋系统**：隐藏奖励和特殊活动
- **人脸验证**：确保授权用户上传
- **每日情话**：展示浪漫语录
- **天气集成**：根据天气推荐拍照主题
- **纪念日追踪**：庆祝恋爱里程碑