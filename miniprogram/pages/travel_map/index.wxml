<view class="travel-map-container">
  <view class="dashboard-card paper-texture">
    <view class="dashboard-row">
      <view class="status-item">
        <view class="status-icon-bg energy-bg">
          <text class="status-icon">âš¡</text>
        </view>
        <view class="status-info">
          <text class="status-label">ç²¾åŠ›å€¼</text>
          <text class="status-value">{{petEnergy}}/100</text>
        </view>
      </view>

      <view class="status-item">
        <view class="status-icon-bg mood-bg">
          <text class="status-icon">â¤ï¸</text>
        </view>
        <view class="status-info">
          <text class="status-label">å¿ƒæƒ…</text>
          <text class="status-value">{{moodValue}}/100</text>
        </view>
      </view>
    </view>
    <view class="dashboard-divider"></view>
    <view class="inventory-row">
      <view class="inventory-label">
        <text>ğŸ’ ä¾¿å½“åº“å­˜</text>
      </view>
      <view class="food-badges">
        <view class="food-badge">
          <text>ğŸ™ é¥­å›¢ x{{foodCount.rice_ball || 0}}</text>
        </view>
        <view class="food-badge luxury">
          <text>ğŸ± å¾¡è†³ x{{foodCount.luxury_bento || 0}}</text>
        </view>
      </view>
    </view>
  </view>

  <view wx:if="{{loading}}" class="loading-container">
    <text class="loading-text">æ­£åœ¨è§„åˆ’æ—…è¡Œè·¯çº¿...</text>
  </view>

  <scroll-view wx:else scroll-y class="destinations-scroll">
    <view wx:if="{{destinations.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ—ºï¸</text>
      <text class="empty-text">æš‚æ— å¯å‰å¾€çš„ç›®çš„åœ°</text>
      <text class="empty-desc">å¤šå»æ¢ç´¢ï¼Œè§£é”æ›´å¤šæ—…è¡Œåœ°ç‚¹å§ï¼</text>
    </view>

    <block wx:else>
      <view class="destinations-section" wx:if="{{availableDestinations.length > 0}}">
        <view class="section-header">
          <text class="section-icon">ğŸ“</text>
          <text class="section-title">å‡†å¤‡å‡ºå‘</text>
        </view>
        
        <view wx:for="{{availableDestinations}}" wx:key="id" class="destination-card paper-texture ripple-effect" bindtap="onSelectDestination" data-destination="{{item}}">
          <image class="destination-image" src="{{item.image}}" mode="aspectFill"></image>
          
          <view class="destination-content">
            <view class="card-top">
              <text class="destination-name">{{item.name}}</text>
              <view class="tag-time">
                <text>â±ï¸ {{item.duration}}åˆ†é’Ÿ</text>
              </view>
            </view>

            <text class="destination-desc">{{item.description}}</text>

            <view class="card-footer">
              <view class="requirements">
                <text class="req-tag">ğŸ± {{item.food_required === 'any' ? 'ä»»æ„ä¾¿å½“' : (item.food_required === 'luxury_bento' ? 'è±ªåå¾¡è†³' : 'é¥­å›¢ä¾¿å½“')}}</text>
              </view>
              <view class="action-btn-area">
                <text class="go-btn-text">GO ğŸš€</text>
              </view>
            </view>
          </view>
        </view>
      </view>

      <view wx:if="{{lockedDestinations.length > 0}}" class="destinations-section">
        <view class="section-header">
          <text class="section-icon">ğŸ”’</text>
          <text class="section-title">ç­‰å¾…æ¢ç´¢</text>
        </view>

        <view wx:for="{{lockedDestinations}}" wx:key="id" class="destination-card paper-texture locked">
          <view class="locked-overlay">
            <text class="lock-big-icon">ğŸ”’</text>
            <text class="lock-condition">{{item.unlock_condition || 'æœªè§£é”'}}</text>
          </view>
          <image class="destination-image" src="{{item.image}}" mode="aspectFill"></image>
          
          <view class="destination-content">
            <view class="card-top">
              <text class="destination-name">{{item.name}}</text>
            </view>
            <view class="unlock-hint-box">
              <text class="hint-icon">ğŸ’¡</text>
              <text class="hint-text">{{item.unlock_hint || 'å®Œæˆæ›´å¤šæ—…è¡Œæ¥è§£é”'}}</text>
            </view>
          </view>
        </view>
      </view>
    </block>
    <view style="height: 40rpx;"></view>
  </scroll-view>

  <view class="modal-mask {{showTravelModal ? 'show' : ''}}" bindtap="closeTravelModal">
    <view class="travel-modal paper-texture" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">ç¡®è®¤è¡Œç¨‹</text>
        <view class="close-btn" bindtap="closeTravelModal">Ã—</view>
      </view>

      <view wx:if="{{selectedDestination}}" class="modal-content">
        <image class="modal-destination-image" src="{{selectedDestination.image}}" mode="aspectFill"></image>
        <text class="modal-destination-name">{{selectedDestination.name}}</text>
        
        <view class="modal-info-grid">
           <view class="info-cell">
             <text class="cell-label">é¢„è®¡è€—æ—¶</text>
             <text class="cell-value">{{selectedDestination.duration}} åˆ†é’Ÿ</text>
           </view>
           <view class="info-cell">
             <text class="cell-label">æ¶ˆè€—ç²¾åŠ›</text>
             <text class="cell-value">-{{TRAVEL_ENERGY_COST}}</text>
           </view>
        </view>

        <view class="food-selection-area">
          <text class="area-title">é€‰æ‹©ä¾¿å½“</text>
          <view wx:if="{{availableFoods.length > 0}}" class="food-radio-group">
            <radio-group bindchange="onFoodChange">
              <label wx:for="{{availableFoods}}" wx:key="type" class="food-option-item {{item.type === selectedFood ? 'selected' : ''}}">
                <view class="food-option-left">
                  <radio value="{{item.type}}" checked="{{item.type === selectedFood}}"/>
                  <view class="food-details">
                    <text class="food-name">{{item.name}}</text>
                    <text class="food-bonus" wx:if="{{item.bonus}}">å¿ƒæƒ… +{{item.bonus}}</text>
                  </view>
                </view>
                <text class="food-count-badge">x{{item.count}}</text>
              </label>
            </radio-group>
          </view>
          
          <view wx:else class="no-food-warning">
            <text>âš ï¸ èƒŒåŒ…é‡Œæ²¡æœ‰ç¬¦åˆè¦æ±‚çš„ä¾¿å½“</text>
          </view>
        </view>
      </view>

      <view class="modal-actions">
        <button class="modal-btn cancel-btn" bindtap="closeTravelModal">å†æƒ³æƒ³</button>
        <button wx:if="{{canTravel}}" class="modal-btn confirm-btn" bindtap="confirmTravel">å‡ºå‘</button>
        <button wx:else class="modal-btn confirm-btn disabled" disabled>æ— æ³•å‡ºå‘</button>
      </view>
    </view>
  </view>
</view>