<view class="travel-map-container">
  <!-- Header with Back Button -->
  <view class="page-header">
    <view class="back-btn" bindtap="goBack">
      <text class="back-icon">â†</text>
    </view>
    <text class="page-title">ğŸ—ºï¸ æ—…è¡Œåœ°å›¾</text>
  </view>

  <!-- Pet Status Bar -->
  <view class="pet-status-bar paper-texture">
    <view class="status-item">
      <text class="status-icon">âš¡</text>
      <text class="status-label">ç²¾åŠ›å€¼</text>
      <text class="status-value">{{petEnergy}}/{{TRAVEL_ENERGY_COST}}</text>
    </view>
    <view class="status-item">
      <text class="status-icon">ğŸ’</text>
      <text class="status-label">ä¾¿å½“</text>
      <view class="food-count">
        <text class="food-item">ğŸ± {{foodCount.rice_ball || 0}}</text>
        <text class="food-item">ğŸ± {{foodCount.luxury_bento || 0}}</text>
      </view>
    </view>
    <view class="status-item">
      <text class="status-icon">â¤ï¸</text>
      <text class="status-label">å¿ƒæƒ…</text>
      <text class="status-value">{{moodValue}}/100</text>
    </view>
  </view>

  <!-- Loading State -->
  <view wx:if="{{loading}}" class="loading-container">
    <text class="loading-text">æ­£åœ¨åŠ è½½åœ°å›¾...</text>
  </view>

  <!-- Destinations List -->
  <scroll-view wx:else scroll-y class="destinations-scroll">
    <view wx:if="{{destinations.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ—ºï¸</text>
      <text class="empty-text">æš‚æ— å¯å‰å¾€çš„ç›®çš„åœ°</text>
      <text class="empty-desc">å¤šå»æ¢ç´¢ï¼Œè§£é”æ›´å¤šæ—…è¡Œåœ°ç‚¹å§ï¼</text>
    </view>

    <block wx:else>
      <!-- Section: Available Destinations -->
      <view class="destinations-section">
        <text class="section-title">ğŸ“ å¯å‰å¾€çš„ç›®çš„åœ°</text>
        <view wx:for="{{availableDestinations}}" wx:key="id" class="destination-card paper-texture {{item.unlocked ? 'unlocked' : 'locked'}}">
          <image class="destination-image" src="{{item.image}}" mode="aspectFill"></image>

          <view class="destination-info">
            <view class="destination-header">
              <text class="destination-name">{{item.name}}</text>
              <view wx:if="{{!item.unlocked}}" class="lock-badge">
                <text class="lock-icon">ğŸ”’</text>
                <text class="lock-text">æœªè§£é”</text>
              </view>
            </view>

            <text class="destination-desc">{{item.description}}</text>

            <view class="travel-requirements">
              <view class="requirement-item">
                <text class="req-icon">â±ï¸</text>
                <text class="req-text">æ—…è¡Œæ—¶é•¿</text>
                <text class="req-value">{{item.duration}}åˆ†é’Ÿ</text>
              </view>

              <view class="requirement-item">
                <text class="req-icon">ğŸ±</text>
                <text class="req-text">éœ€è¦ä¾¿å½“</text>
                <text class="req-value">{{item.food_required}}</text>
              </view>

              <view class="requirement-item">
                <text class="req-icon">ğŸ’</text>
                <text class="req-text">å¯èƒ½è·å¾—</text>
                <text class="req-value">{{item.possible_rewards.join(', ')}}</text>
              </view>
            </view>

            <view class="destination-actions">
              <button wx:if="{{!item.unlocked}}" class="action-btn unlock-btn" disabled>
                <text>ğŸ”’ éœ€è¦è§£é”</text>
              </button>

              <button wx:else class="action-btn travel-btn" bindtap="onSelectDestination" data-destination="{{item}}">
                <text>ğŸš€ é€‰æ‹©è¿™é‡Œ</text>
              </button>
            </view>
          </view>
        </view>
      </view>

      <!-- Section: Locked Destinations -->
      <view wx:if="{{lockedDestinations.length > 0}}" class="destinations-section">
        <text class="section-title">ğŸ”’ æœªè§£é”çš„ç›®çš„åœ°</text>
        <view wx:for="{{lockedDestinations}}" wx:key="id" class="destination-card paper-texture locked">
          <image class="destination-image" src="{{item.image}}" mode="aspectFill"></image>

          <view class="destination-info">
            <view class="destination-header">
              <text class="destination-name">{{item.name}}</text>
              <view class="lock-badge">
                <text class="lock-icon">ğŸ”’</text>
                <text class="lock-text">{{item.unlock_condition || 'æœªè§£é”'}}</text>
              </view>
            </view>

            <text class="destination-desc">{{item.description}}</text>

            <view class="unlock-hint">
              <text class="hint-icon">ğŸ’¡</text>
              <text class="hint-text">{{item.unlock_hint || 'å®Œæˆæ›´å¤šæ—…è¡Œæ¥è§£é”'}}</text>
            </view>
          </view>
        </view>
      </view>
    </block>
  </scroll-view>

  <!-- Travel Confirmation Modal -->
  <view class="modal-mask {{showTravelModal ? 'show' : ''}}" bindtap="closeTravelModal">
    <view class="travel-modal paper-texture" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">ç¡®è®¤æ—…è¡Œ</text>
        <view class="close-btn" bindtap="closeTravelModal">Ã—</view>
      </view>

      <view wx:if="{{selectedDestination}}" class="modal-content">
        <image class="modal-destination-image" src="{{selectedDestination.image}}" mode="aspectFill"></image>

        <text class="modal-destination-name">{{selectedDestination.name}}</text>
        <text class="modal-travel-time">é¢„è®¡ {{selectedDestination.duration}} åˆ†é’Ÿåè¿”å›</text>

        <view class="modal-costs">
          <view class="cost-item">
            <text class="cost-icon">âš¡</text>
            <text class="cost-text">æ¶ˆè€—ç²¾åŠ›</text>
            <text class="cost-value">{{TRAVEL_ENERGY_COST}}</text>
          </view>
          <view class="cost-item">
            <text class="cost-icon">ğŸ±</text>
            <text class="cost-text">æ¶ˆè€—ä¾¿å½“</text>
            <text class="cost-value">{{selectedDestination.food_required}}</text>
          </view>
        </view>

        <view wx:if="{{availableFoods.length > 0}}" class="food-selection">
          <text class="selection-title">é€‰æ‹©ä¾¿å½“ï¼š</text>
          <radio-group bindchange="onFoodChange">
            <label wx:for="{{availableFoods}}" wx:key="type" class="food-option">
              <radio value="{{item.type}}" checked="{{item.type === selectedFood}}"/>
              <view class="food-info">
                <text class="food-name">{{item.name}}</text>
                <text class="food-count">({{item.count}}ä¸ª)</text>
                <text class="food-effect" wx:if="{{item.bonus}}">+{{item.bonus}}å¿ƒæƒ…å€¼</text>
              </view>
            </label>
          </radio-group>
        </view>

        <view wx:else class="no-food-warning">
          <text class="warning-icon">âš ï¸</text>
          <text class="warning-text">ä½ æ²¡æœ‰è¶³å¤Ÿçš„ä¾¿å½“ï¼</text>
          <text class="warning-desc">å¿«å»å‡†å¤‡ä¾¿å½“å§</text>
        </view>
      </view>

      <view class="modal-actions">
        <button class="modal-btn cancel-btn" bindtap="closeTravelModal">å–æ¶ˆ</button>
        <button wx:if="{{canTravel}}" class="modal-btn confirm-btn" bindtap="confirmTravel">ç¡®è®¤å‡ºå‘</button>
        <button wx:else class="modal-btn confirm-btn disabled" disabled>æ— æ³•å‡ºå‘</button>
      </view>
    </view>
  </view>
</view>