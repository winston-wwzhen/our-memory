<view class="journal-container">
  
  <view class="content-wrapper">
    <view class="task-note-container slide-in-down" wx:if="{{currentTask}}">
      <view class="task-note">
        <view class="note-header">
          <text class="note-icon">{{currentTask.icon}}</text>
          <view class="header-text">
            <text class="note-label">ä»Šæ—¥é™å®š</text>
            <text class="note-title">{{currentTask.title}}</text>
          </view>
        </view>
        <text class="note-desc">{{currentTask.description}}</text>
        
        <view class="remote-tip-box">
          <text>ğŸ’¡ å¼‚åœ°è´´å£«ï¼šè§†é¢‘é€šè¯æˆªå›¾ä¹Ÿèƒ½ç”œèœœæš´å‡»å“¦ï¼</text>
        </view>

        <view class="note-footer">
          <text class="difficulty-tag">ç”œèœœåº¦ Lv.{{currentTask.difficulty}}</text>
          <text class="date-tag">{{todayDateStr}}</text>
        </view>
      </view>
    </view>

    <view class="polaroid-frame {{loading ? 'developing-pulse' : 'floating-updown'}}" bindtap="{{!pendingSave ? 'onCapture' : ''}}">
      <view class="photo-area">
        
        <image 
          src="{{displayImage}}" 
          mode="aspectFill" 
          class="the-photo"
          wx:if="{{displayImage}}"
        ></image>

        <view class="empty-state-cover" wx:else>
          
          <image 
            src="{{randomSampleImg}}" 
            mode="aspectFill" 
            class="sample-img-bg"
          ></image> 
          
          <image 
            src="{{randomSampleImg}}" 
            mode="aspectFit" 
            class="sample-img-main"
          ></image> 
          
          <view class="empty-overlay">
            <view class="camera-btn-circle">
              <view class="btn-ripple"></view>
              <image src="../../images/camera-icon.png" class="camera-icon-img"></image>
            </view>
            <text class="empty-hint">ç‚¹å‡»æ­¤å¤„ è®°å½•å¿ƒåŠ¨</text>
          </view>
        </view>

        <view class="loading-mask" wx:if="{{loading}}">
          <view class="loading-spinner"></view>
          <text class="loading-text">AI æ­£åœ¨ç»˜å›¾ä¸­...</text>
        </view>

      </view>
      
      <view class="handwriting-caption">
        <text wx:if="{{loading}}">æ­£åœ¨æ–½å±•é­”æ³•...</text>
        <text wx:elif="{{displayImage}}" class="success-text">âœ¨ Our Magic Moment âœ¨</text>
        <text wx:else class="waiting-text">Create your memory</text>
      </view>
    </view>

    <view class="daily-quote-box fade-in" wx:if="{{!pendingSave}}">
      <text class="quote-text">â€œ{{dailyQuote.text}}â€</text>
      <text class="quote-author">â€” {{dailyQuote.author}} â€”</text>
    </view>

    <view class="action-bar slide-in-up" wx:if="{{pendingSave}}">
      <view class="confirm-actions">
        <view class="action-btn-wrapper" catchtap="onSaveToPhone">
          <view class="btn-circle sub"><text>â¬‡ï¸</text></view>
          <text class="btn-label">ä¿å­˜</text>
        </view>

        <view class="action-btn-wrapper" catchtap="onRetry">
          <view class="btn-circle sub"><text>ğŸ”„</text></view>
          <text class="btn-label">é‡æ‹ ({{remainingCount}})</text>
        </view>

        <button class="btn-confirm-main" catchtap="onConfirmSave">
          ç¡®è®¤æ‰“å¡
        </button>
      </view>
    </view>

  </view>
</view>