<view class="journal-container">
  
  <view class="ambient-light top-light"></view>
  <view class="ambient-light bottom-light"></view>

  <view class="content-wrapper">
    <view class="task-note-container" wx:if="{{currentTask}}">
      <view class="washi-tape tape-top-left"></view>
      
      <view class="task-note">
        <view class="note-header">
          <text class="note-icon">{{currentTask.icon}}</text>
          <text class="note-title">ä»Šæ—¥é™å®šï¼š{{currentTask.title}}</text>
        </view>
        <text class="note-desc">{{currentTask.description}}</text>

        <view class="remote-tip-box">
          <text class="remote-icon">ğŸ“¡</text>
          <text class="remote-text">å¼‚åœ°æ‹å°è´´å£«ï¼šè§†é¢‘é€šè¯æˆªå›¾ä¹Ÿèƒ½ç”œèœœæš´å‡»å“¦ï¼</text>
        </view>

        <view class="note-footer">
          <text class="difficulty-tag">ç”œèœœåº¦ Lv.{{currentTask.difficulty}}</text>
          <text class="date-tag">{{todayDateStr}}</text>
        </view>
      </view>
    </view>

    <view class="polaroid-frame {{loading ? 'developing-pulse' : ''}}">
      <view class="photo-area">
        <image 
          src="{{displayImage}}" 
          mode="aspectFill" 
          class="the-photo"
          wx:if="{{displayImage}}"
        ></image>
        <view class="placeholder-state" wx:else>
           <view class="css-camera-icon">
            <view class="cam-body">
              <view class="cam-lens"></view>
              <view class="cam-flash"></view>
            </view>
          </view>
          <text class="placeholder-text">ç‚¹å‡»å¿«é—¨ï¼Œæ•æ‰ä»Šæ—¥ä»½å¿ƒåŠ¨</text>
        </view>
      </view>
      
      <view class="handwriting-caption">
        <text wx:if="{{loading}}">æ­£åœ¨å†²æ´—çˆ±çš„å½±åƒ...</text>
        <text wx:elif="{{displayImage}}" class="success-text">âœ¨ Our Magic Moment âœ¨</text>
        <text wx:else class="waiting-text">Waiting for us...</text>
      </view>
    </view>

    <view class="action-bar">
      
      <block wx:if="{{!pendingSave}}">
        <button 
          class="shutter-button" 
          bindtap="onCapture" 
          disabled="{{loading}}"
          hover-class="shutter-hover"
        >
          <view class="shutter-inner">
            <view class="shutter-icon"></view>
          </view>
        </button>
        <text class="action-hint">Tap to mark</text>
      </block>

      <block wx:else>
        <view class="confirm-actions">
          
          <view class="action-btn-wrapper" bindtap="onSaveToPhone">
            <button class="btn-icon" size="mini">â¬‡ï¸</button>
            <text class="btn-label">ä¿å­˜</text>
          </view>

          <view class="action-btn-wrapper" bindtap="onRetry">
            <button class="btn-icon" size="mini">ğŸ”„</button>
            <text class="btn-label">é‡æ‹ (å‰©{{remainingCount}}æ¬¡)</text>
          </view>

          <button class="btn-confirm-main" bindtap="onConfirmSave">
            ç¡®è®¤æ‰“å¡
          </button>

        </view>
      </block>
    </view>
  </view>
</view>