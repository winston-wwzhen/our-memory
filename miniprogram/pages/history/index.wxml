<view class="history-container">
  <view class="timeline-header">
    <text class="title">我们的时光轴</text>
    <text class="subtitle">收集每一个心动瞬间</text>
    
    <view class="surprise-banner" bindtap="{{!hasPartner ? 'navToMine' : ''}}">
      <view class="gift-box">
        <text class="gift-icon">🎁</text>
      </view>

      <view class="gift-content">
        <block wx:if="{{!hasPartner}}">
           <view class="gift-title" style="color: #8d6e63;">暂无特殊奖励</view>
           <view class="gift-desc">绑定伴侣并完成打卡任务，可获得奖励 ✨</view>
        </block>

        <block wx:else>
            <view class="gift-title">
              已珍藏 <text class="days-highlight">{{totalDays}}</text> 个心动瞬间
            </view>
            
            <view class="gift-desc" wx:if="{{totalDays < 30}}">
              再记录 <text class="days-left">{{30 - totalDays}}</text> 个心动瞬间，解锁【动态时光影集】✨
            </view>
            <view class="gift-desc" wx:else>
              🎉 恭喜达成30天成就！神秘惊喜准备中...
            </view>
        </block>
      </view>
    </view>
  </view>

  <view class="timeline-content">
    <view wx:if="{{memories.length === 0}}" class="empty-state">
      <text>这里空空如也，快去创造属于我们的独家记忆吧！📸</text>
    </view>

    <block wx:for="{{memories}}" wx:key="_id">
      <view class="timeline-item">
        <view class="time-node">
          <view class="dot"></view>
          <view class="line"></view>
        </view>
        
        <view class="memory-card {{item.isMine ? 'mine-card' : 'partner-card'}}">
          <view class="card-header">
            <text class="user-tag">{{item.isMine ? 'ME' : 'TA'}}</text>
            <view class="card-date">{{item.originalDate}}</view>
          </view>
          
          <image 
            src="{{item.imageFileID}}" 
            mode="aspectFill" 
            class="card-img" 
            bindtap="previewImage" 
            data-src="{{item.imageFileID}}"
          ></image>
          
          <view class="card-tag">{{item.style || 'Sweet Moment'}}</view>
        </view>
      </view>
    </block>
  </view>
</view>