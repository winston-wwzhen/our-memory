<view class="mine-container">
  <view class="timer-card paper-texture">
    <view class="timer-header">
      <text class="timer-title">æˆ‘ä»¬å·²ç»ç›¸çˆ±</text>
      <picker mode="date" value="{{anniversary}}" bindchange="onDateChange">
        <view class="timer-setting">
          <text wx:if="{{anniversary}}">èµ·å§‹æ—¥: {{anniversary}}</text>
          <text wx:else>âš™ï¸ è®¾ç½®çºªå¿µæ—¥</text>
        </view>
      </picker>
    </view>
    
    <view class="timer-content">
      <text class="timer-number">{{daysCount}}</text>
      <text class="timer-unit">å¤©</text>
    </view>
    <view class="timer-footer">Love is a long journey.</view>
  </view>
  
  <view class="user-card paper-texture">
    <button 
      class="avatar-wrapper" 
      open-type="chooseAvatar" 
      bind:chooseavatar="onChooseAvatar"
    >
      <image 
        class="avatar-img" 
        src="{{userData.avatarUrl || '../../images/default-avatar.png'}}" 
        mode="aspectFill"
      ></image>
      <view class="edit-badge">ğŸ“·</view>
    </button>

    <view class="nickname-row">
      <view class="nickname-box">
        <input 
          type="nickname" 
          class="nickname-input" 
          placeholder="ç‚¹å‡»è®¾ç½®æ˜µç§°" 
          placeholder-class="nickname-placeholder"
          value="{{userData.nickName}}" 
          bind:change="onInputNickname"
        />
        <text class="edit-icon">âœ</text>
      </view>
    </view>
    
    <view class="status-tag {{userData.partner_id ? 'connected' : 'waiting'}}">
      <text wx:if="{{userData.partner_id}}">â¤ï¸ æ‹çˆ±çºªå¿µå†Œ</text>
      <text wx:else>âœ¨ å¼€å¯å•äººç¯‡ç« </text>
    </view>

    <button 
      class="btn-save" 
      bindtap="saveProfile" 
      size="mini"
      wx:if="{{needSave}}"
    >ä¿å­˜èµ„æ–™</button>
  </view>

  <view class="action-card paper-texture" wx:if="{{!userData.partner_id}}">
    <view class="card-header">
      <text class="card-title">é‚€è¯·å¦ä¸€åŠ</text>
      <text class="card-subtitle">Invite your love</text>
    </view>
    
    <view class="code-section">
      <text class="label">æˆ‘çš„ä¸“å±ç¼–å·</text>
      <view class="code-display" bindtap="copyMyKey">
        <text class="code-text">{{userData._openid || 'ç”Ÿæˆä¸­...'}}</text>
        <view class="copy-tag">å¤åˆ¶</view>
      </view>
      <button class="btn-share-pill" open-type="share">
        ğŸ“¤ å‘é€ç»™ TA
      </button>
    </view>

    <view class="divider-line"></view>

    <view class="input-section">
      <text class="label">å¡«å…¥ TA çš„ç¼–å·</text>
      <view class="input-wrapper">
        <input 
          class="code-input" 
          placeholder="åœ¨æ­¤ç²˜è´´ TA çš„ç¼–å·..." 
          bindinput="onInputKey"
          value="{{inputPartnerCode}}"
        />
      </view>
      <button class="btn-connect-pill" bindtap="bindPartner">ç¡®è®¤å…³è”</button>
    </view>
  </view>

  <view class="action-card paper-texture connected-state" wx:else>
    
    <view class="bg-decoration">âœ¨</view>

    <view class="cp-avatars-box">
      <image 
        class="cp-avatar mine" 
        src="{{userData.avatarUrl || '../../images/default-avatar.png'}}" 
        mode="aspectFill"
      ></image>
      
      <view class="heart-beat">â¤</view>
      
      <image 
        class="cp-avatar partner" 
        src="{{partnerData.avatarUrl || '../../images/default-avatar.png'}}" 
        mode="aspectFill"
      ></image>
    </view>

    <view class="love-content">
      <text class="love-title">æˆ‘ä»¬æ­£åœ¨å…±åŒè®°å½•</text>
      
      <text class="love-partner" wx:if="{{partnerData.nickName}}">ä¸ {{partnerData.nickName}}</text>
      <text class="love-partner" wx:else>ä¸ TA ({{partnerShortID}})</text>
      
      <text class="love-desc-sub">æœªæ¥çš„æ¯ä¸€å¤©ï¼Œéƒ½å€¼å¾—è¢«çè—ã€‚</text>
    </view>
    
    <view class="footer-actions">
      <view class="unbind-link" bindtap="onUnbind">è§£é™¤å…³è”</view>
    </view>
  </view>

  <view class="footer-info">
    <text>Designed for Love</text>
  </view>

</view>